<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>A mostly codeless intro to D3</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/ft.css" id="theme">
		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
<style type="text/css">
svg{
	stroke: #000;
	font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif; 
}

#rim {
  fill: none;
  stroke: #999;
  stroke-width: 3px;
}

.second-hand{
	stroke-width:3;

}

.minute-hand{
	stroke-width:8;
	stroke-linecap:round;
}

.hour-hand{
	stroke-width:12;
	stroke-linecap:round;
}

.hands-cover{
	stroke-width:3;
	fill:#fff;
}

.second-tick{
	stroke-width:3;
	fill:#000;	
}

.hour-tick{
	stroke-width:8; //same as the miute hand
}

.second-label{
	font-size: 12px;
}

.hour-label{
	font-size: 24px;
}


</style>
</style>
		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<!-- the character F is the FT logotype -->
					<h2 class="logo">F</h2>
				</section>
				
				<section>
					<h2>Tom Pearson</h2>
					<p>tom.pearson@ft.com
					<p>@tomp
				</section>
				<section>
					<img src="img/d3/D3Thesis.png" height="100%">
				</section>
				<section>
					<img src="img/loyaltycard.png" height="100%">
				</section>
				<section>
					<img src="img/chess.png" width="100%">
				</section>
				<section>
					<img src="img/football.png" width="100%">
				</section>
				<section>
					<img src="img/sequestrationmap.jpg" width="100%">
				</section>
				<section>
					<h1>Myths<br> &<br> Misconceptions</h1>
				</section>
				<section>
					<h2>It's hard!</h2>
				</section>
				<section>
					<img src="img/d3/charttypology.png">
					<h3>It's for making charts!</h3>
				</section>
				<section>
					<h2>A design pattern for data viz</h2>
				</section>
				<section>
					Data &rarr; Page elements
				</section>
				<section>
					Data &rarr; Transformations &rarr; Scales &rarr; Page elements
				</section>
				<section>
					<h2>Getting Data</h2>
<pre>

	d3.csv('mydata.csv', function(data){
	   //Ta da!
	});

</pre>
				</section>
				<section>
					<h2>Transforming data</h2>
<pre>

	d3.min(array[, accessor])    // & max
	d3.extent(array[, accessor])
	d3.mean(array[, accessor])   // & sum & median
	d3.quantile(numbers, p)
	d3.nest()                    //very powerful
	// ...and loads more!

</pre>
				</section>

				<section>
					<h3>Binding data to page elements</h3>
					<img src="img/d3/selections1.png"><p>
					<cite class="citation-link"><a href="http://bost.ocks.org/mike/selection">bost.ocks.org/mike/selection</a></cite>
				</section>
				<section>
					<h3>Binding data to page elements</h3>
					<img src="img/d3/selections2.png"><p>
					<cite class="citation-link"><a href="http://bost.ocks.org/mike/selection">bost.ocks.org/mike/selection</a></cite>
				</section>
				<section>
					<h2>Scales</h2>
					map the <em>properties</em> of the data to <em>attributes</em> of the page elements
					<img src="img/d3/d3scale1.png">
					<p><cite class="citation-link"><a href="http://www.jeromecukier.net/blog/2011/08/11/d3-scales-and-color/">www.jeromecukier.net</a></cite>
				</section>			
				<section>
					<h2>Learn by example</h2>
					<p>
					<cite><a href="http://bl.ocks.org/mbostock">bl.ocks.org/mbostock</a></cite>
				</section>
				<section>
					<img src="img/d3/blocks1.png" height="100%">
					<p>
				</section>
				<section>
					<img src="img/d3/blocks2.png" height="100%">
					<p>
				</section>
				<section>
					<div id="clock">
					</div>
					<h3>d3js.org</h3>
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>
		<script src="js/d3.v3.min.js"></script>
		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>
		<script>

var radians = 0.0174532925, 
	clockRadius = 200,
	margin = 50,
	width = (clockRadius+margin)*2,
    height = (clockRadius+margin)*2,
    hourHandLength = 2*clockRadius/3,
    minuteHandLength = clockRadius,
    secondHandLength = clockRadius-12,
    secondHandBalance = 30,
    secondTickStart = clockRadius;
    secondTickLength = -10,
    hourTickStart = clockRadius,
    hourTickLength = -18
    secondLabelRadius = clockRadius + 16;
    secondLabelYOffset = 5
    hourLabelRadius = clockRadius - 40
    hourLabelYOffset = 7;


var hourScale = d3.scale.linear()
	.range([0,330])
	.domain([0,11]);

var minuteScale = secondScale = d3.scale.linear()
	.range([0,354])
	.domain([0,59]);

var handData = [
	{
		type:'hour',
		value:0,
		length:-hourHandLength,
		scale:hourScale
	},
	{
		type:'minute',
		value:0,
		length:-minuteHandLength,
		scale:minuteScale
	},
	{
		type:'second',
		value:0,
		length:-secondHandLength,
		scale:secondScale,
		balance:secondHandBalance
	}
];

function drawClock(){ //create all the clock elements
	updateData();	//draw them in the correct starting position
	var svg = d3.select("#clock").append("svg")
	    .attr("width", width)
	    .attr("height", height);

	var face = svg.append('g')
		.attr('id','clock-face')
		.attr('transform','translate(' + (clockRadius + margin) + ',' + (clockRadius + margin) + ')');

	//add marks for seconds
	face.selectAll('.second-tick')
		.data(d3.range(0,60)).enter()
			.append('line')
			.attr('class', 'second-tick')
			.attr('x1',0)
			.attr('x2',0)
			.attr('y1',secondTickStart)
			.attr('y2',secondTickStart + secondTickLength)
			.attr('transform',function(d){
				return 'rotate(' + secondScale(d) + ')';
			});
	//and labels

	face.selectAll('.second-label')
		.data(d3.range(5,61,5))
			.enter()
			.append('text')
			.attr('class', 'second-label')
			.attr('text-anchor','middle')
			.attr('x',function(d){
				return secondLabelRadius*Math.sin(secondScale(d)*radians);
			})
			.attr('y',function(d){
				return -secondLabelRadius*Math.cos(secondScale(d)*radians) + secondLabelYOffset;
			})
			.text(function(d){
				return d;
			});

	//... and hours
	face.selectAll('.hour-tick')
		.data(d3.range(0,12)).enter()
			.append('line')
			.attr('class', 'hour-tick')
			.attr('x1',0)
			.attr('x2',0)
			.attr('y1',hourTickStart)
			.attr('y2',hourTickStart + hourTickLength)
			.attr('transform',function(d){
				return 'rotate(' + hourScale(d) + ')';
			});

	face.selectAll('.hour-label')
		.data(d3.range(3,13,3))
			.enter()
			.append('text')
			.attr('class', 'hour-label')
			.attr('text-anchor','middle')
			.attr('x',function(d){
				return hourLabelRadius*Math.sin(hourScale(d)*radians);
			})
			.attr('y',function(d){
				return -hourLabelRadius*Math.cos(hourScale(d)*radians) + hourLabelYOffset;
			})
			.text(function(d){
				return d;
			});


	var hands = face.append('g').attr('id','clock-hands');

	face.append('g').attr('id','face-overlay')
		.append('circle').attr('class','hands-cover')
			.attr('x',0)
			.attr('y',0)
			.attr('r',clockRadius/20);

	hands.selectAll('line')
		.data(handData)
			.enter()
			.append('line')
			.attr('class', function(d){
				return d.type + '-hand';
			})
			.attr('x1',0)
			.attr('y1',function(d){
				return d.balance ? d.balance : 0;
			})
			.attr('x2',0)
			.attr('y2',function(d){
				return d.length;
			})
			.attr('transform',function(d){
				return 'rotate('+ d.scale(d.value) +')';
			});
		}

		function moveHands(){
			d3.select('#clock-hands').selectAll('line')
			.data(handData)
				.transition()
				.attr('transform',function(d){
					return 'rotate('+ d.scale(d.value) +')';
				});
		}

		function updateData(){
			var t = new Date();
			handData[0].value = (t.getHours() % 12) + t.getMinutes()/60 ;
			handData[1].value = t.getMinutes();
			handData[2].value = t.getSeconds();
		}

		drawClock();

		setInterval(function(){
			updateData();
			moveHands();
		}, 1000);

		d3.select(self.frameElement).style("height", height + "px");
		</script>

	</body>
</html>
